(this["webpackJsonptrade-wars-static"]=this["webpackJsonptrade-wars-static"]||[]).push([[0],{43:function(e,t,a){e.exports=a(69)},48:function(e,t,a){},50:function(e,t,a){},55:function(e,t,a){},57:function(e,t,a){},69:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(27),s=a.n(i),o=(a(48),a(49),a(50),a(7)),c=a(8),l=a(11),m=a(9),p=a(10),u=a(24),y=a(21),h=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.routes;return Object.keys(e).map((function(t,a){return e[t].disabled?null:r.a.createElement(y.b,{key:a,exact:!0,path:e[t].path,component:e[t].component})}))}}]),t}(n.Component),d=a(5),g=a(70),b=a(71),f=a(73),v=a(72),O=(a(55),a(20)),k="ADD_PLAYERNAME",j="ADD_WEBSOCKET";function S(e){return{type:k,payload:e}}function w(e){return{type:j,payload:e}}var N=a(22),E=a.n(N);var P=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).state={playerName:-1,socket:a.props.webSocket},a.tempPlayerName="",a.setPlayerName=a.setPlayerName.bind(Object(d.a)(a)),a.changeTempPlayerName=a.changeTempPlayerName.bind(Object(d.a)(a)),a.readyForRedirect=a.readyForRedirect.bind(Object(d.a)(a)),a.findCookieCallSign=a.findCookieCallSign.bind(Object(d.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.state.socket.onopen=function(){setInterval((function(){e.state.socket.send(JSON.stringify({command:"ping"}))}),1e4)},this.state.socket.onmessage=function(e){console.log(e)}}},{key:"changeTempPlayerName",value:function(e){this.tempPlayerName=e.target.value}},{key:"setPlayerName",value:function(){var e=this;""!==this.tempPlayerName&&this.setState({playerName:this.tempPlayerName},(function(){var t=e.tempPlayerName;E.a.set("callsign",t,{expires:5}),e.props.addPlayername(t)}))}},{key:"findCookieCallSign",value:function(){var e=this;void 0!==E.a.get("callsign")&&this.setState({playerName:this.tempPlayerName},(function(){var t=E.a.get("callsign");e.props.addPlayername(t),e.state.socket.onopen=function(){e.state.socket.send(JSON.stringify({command:"setCallsign",callsign:t})),setInterval((function(){e.state.socket.send(JSON.stringify({command:"ping"}))}),1e4)}}))}},{key:"readyForRedirect",value:function(){if(-1!==this.state.playerName)return r.a.createElement(y.a,{to:"/game"})}},{key:"render",value:function(){return r.a.createElement("div",{className:"get-name-background"},this.findCookieCallSign(),this.readyForRedirect(),r.a.createElement("div",{className:"username-card"},r.a.createElement("h1",null,"Trade Wars!"),r.a.createElement(g.a,null,r.a.createElement(b.a,{onChange:this.changeTempPlayerName,placeholder:"Username"}),r.a.createElement(f.a,{addonType:"append"},r.a.createElement(v.a,{onClick:this.setPlayerName},"Play")))))}}]),t}(n.Component),x=Object(O.b)((function(e){return{webSocket:e.webSocket}}),(function(e){return{addPlayername:function(t){return e(S(t))},addWebSocket:function(t){return e(w(t))}}}))(P),C=(a(57),a(35)),W=a(23),D=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(W.Sprite,{image:"https://cdn1.iconfinder.com/data/icons/space-133/64/spaceship-planet-space-colony-city-512.png",x:this.props.x,y:this.props.y,scale:{x:.05,y:.05}})}}]),t}(n.Component);n.Component;function M(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var H=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).xMove=0,a.yMove=0,a.state={gameWidth:a.props.gameWidth,gameHeight:a.props.gameHeight,playerLocation:{x:0,y:0},players:{}},a.handleKeyPress=a.handleKeyPress.bind(Object(d.a)(a)),a.moveX=a.moveX.bind(Object(d.a)(a)),a.moveY=a.moveY.bind(Object(d.a)(a)),a.convertCordsToGrid=a.convertCordsToGrid.bind(Object(d.a)(a)),a.drawPlayers=a.drawPlayers.bind(Object(d.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.findCookieCallSign(),this.props.webSocket.onopen=function(){setInterval((function(){e.props.webSocket.send(JSON.stringify({command:"ping"}))}),1e4)},this.props.webSocket.onmessage=function(t){var a=JSON.parse(t.data);if("positionUpdate"===a.EventType&&a.Target!==E.a.get("callsign")){var n=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?M(a,!0).forEach((function(t){Object(C.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):M(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e.state.players,Object(C.a)({},a.Target,a.EventParams));e.setState({players:n})}},this.setState({gameWidth:this.state.gameWidth-.012*this.state.gameWidth,gameHeight:this.state.gameHeight-.015*this.state.gameHeight},(function(){e.xMove=e.state.gameWidth/20,e.yMove=e.state.gameHeight/20,e.setState({playerLocation:{x:e.xMove,y:e.yMove-e.yMove/2},playerCords:{x:0,y:0}})})),window.addEventListener("keydown",this.handleKeyPress)}},{key:"handleKeyPress",value:function(e){switch(e.code){case"ArrowUp":this.moveY(-1*this.yMove,1);break;case"ArrowDown":this.moveY(this.yMove,-1);break;case"ArrowLeft":this.moveX(-1*this.xMove,1);break;case"ArrowRight":this.moveX(this.xMove,-1)}}},{key:"moveY",value:function(e,t){var a=this,n={y:this.state.playerLocation.y+e,x:this.state.playerLocation.x},r={y:this.state.playerCords.y+t,x:this.state.playerCords.x};n.y>=0&&n.y<=this.state.gameHeight&&this.setState({playerLocation:{x:n.x,y:n.y},playerCords:{x:r.x,y:r.y}},(function(){a.props.webSocket.send(JSON.stringify({command:"setOwnPosition",x:a.state.playerCords.x,y:a.state.playerCords.y}))}))}},{key:"moveX",value:function(e,t){var a=this,n={y:this.state.playerLocation.y,x:this.state.playerLocation.x+e},r={y:this.state.playerCords.y,x:this.state.playerCords.x+t};n.x+e>=0&&n.x<=this.state.gameWidth&&this.setState({playerLocation:{x:n.x,y:n.y},playerCords:{x:r.x,y:r.y}},(function(){a.props.webSocket.send(JSON.stringify({command:"setOwnPosition",x:a.state.playerCords.x,y:a.state.playerCords.y}))}))}},{key:"findCookieCallSign",value:function(){var e=this;void 0!==E.a.get("callsign")&&this.setState({playerName:this.tempPlayerName},(function(){var t=E.a.get("callsign");e.props.addPlayername(t),e.props.webSocket.onopen=function(){e.props.webSocket.send(JSON.stringify({command:"setCallsign",callsign:t})),setInterval((function(){e.props.webSocket.send(JSON.stringify({command:"ping"}))}),1e4),e.props.webSocket.send(JSON.stringify({command:"getAllPosition"}))}}))}},{key:"convertCordsToGrid",value:function(e,t){return{x:this.xMove*e*-1,y:this.yMove*t*-1}}},{key:"drawPlayers",value:function(){var e=this,t=Object.keys(this.state.players);return console.log(this.state.players),t.map((function(t,a){try{var n=e.convertCordsToGrid(e.state.players[t].x,e.state.players[t].y);return r.a.createElement(D,{key:t,x:n.x,y:n.y})}catch(i){}}))}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(W.Stage,{width:this.state.gameWidth,height:this.state.gameHeight,options:{backgroundColor:1909296}},r.a.createElement(W.Graphics,{x:0,y:0}),r.a.createElement(D,{x:this.state.playerLocation.x,y:this.state.playerLocation.y}),this.drawPlayers()))}}]),t}(n.Component),G=Object(O.b)((function(e){return{webSocket:e.webSocket}}),(function(e){return{addPlayername:function(t){return e(S(t))},addWebSocket:function(t){return e(w(t))}}}))(H),T=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).state=a.props.parentDivDimensions,a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.setState({gameWidth:this.state.gameWidth-.012*this.state.gameWidth,gameHeight:this.state.gameHeight-.015*this.state.gameHeight})}},{key:"render",value:function(){return r.a.createElement(G,{gameWidth:this.state.gameWidth,gameHeight:this.state.gameHeight})}}]),t}(n.Component),L=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).state={gameWidth:-1,gameHeight:-1},a.isPlayernameSet=a.isPlayernameSet.bind(Object(d.a)(a)),a.renderGameStage=a.renderGameStage.bind(Object(d.a)(a)),a.GameDiv=r.a.createRef(),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"isPlayernameSet",value:function(){if(-1===this.props.playerName)return r.a.createElement(y.a,{to:"/"})}},{key:"componentDidMount",value:function(){this.setState({gameWidth:this.GameDiv.current.offsetWidth,gameHeight:this.GameDiv.current.offsetHeight})}},{key:"renderGameStage",value:function(){if(-1!==this.state.gameWidth&&-1!==this.state.gameHeight)return r.a.createElement(T,{parentDivDimensions:this.state})}},{key:"render",value:function(){return r.a.createElement("div",{className:"game-background"},this.isPlayernameSet(),r.a.createElement("h1",{className:"game-title"},"Welcome ",r.a.createElement("u",null,r.a.createElement("b",null,this.props.playerName))," to Trade Wars"),r.a.createElement("div",{className:"game-window-container"},r.a.createElement("div",{ref:this.GameDiv,className:"render-container"},this.renderGameStage()),r.a.createElement("div",{className:"game-status-container"},r.a.createElement("div",{className:"game-cargo-container"},r.a.createElement("p",{className:"game-status-title"},"Cargo")),r.a.createElement("div",{className:"game-status-text-container"},r.a.createElement("p",{className:"game-status-title"},"Messages")))))}}]),t}(n.Component),J={GetName:{path:"/",component:x,disabled:!1},MainGame:{path:"/game",component:L=Object(O.b)((function(e){return{playerName:e.playerName}}))(L),disabled:!1}},A=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(u.a,null,r.a.createElement(h,{routes:J}))}}]),t}(n.Component);var R=function(){return r.a.createElement("div",{className:"App"},r.a.createElement("main",null,r.a.createElement(A,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Y=a(30),I={playerName:-1,webSocket:new WebSocket("wss://trade-wars-backend.herokuapp.com/gameServer")};var K=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case k:return Object.assign({},e,{playerName:e.playerName=t.payload});case j:return Object.assign({},e,{webSocket:e.webSocket=t.payload})}return e},X=Object(Y.b)(K);s.a.render(r.a.createElement(O.a,{store:X},r.a.createElement(R,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[43,1,2]]]);
//# sourceMappingURL=main.32eee2f7.chunk.js.map